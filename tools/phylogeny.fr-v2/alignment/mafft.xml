<tool id="mafft1" name="MAFFT" version="7.205">
    <description>Multiple sequence alignment software</description>
    <macros>
        <import>mafft_macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="7.205">mafft</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error" />
        <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error" />
    </stdio>
    <version_command>
        <![CDATA[ @MAFFT_PATH@ --version ]]>
    </version_command>
    <command>@MAFFT_PATH@ @MAFFT_COMMAND@
    </command>
    <inputs>
        <expand macro="mafft_opt" />
    </inputs>
    <outputs>
        <expand macro="mafft_output" />
    </outputs>
    <tests>
        <test>
            <param name="inputSequences" value="sample.fa"/>
            <param name="flavourType" value="mafft-fftns"/>
            <param name="outputFormat" value="fasta"/>
            <output name="outputFasta" ftype="fasta" file="mafft_fftns_result.aln"/>
        </test>
        <test>
            <param name="inputSequences" value="sample.fa"/>
            <param name="flavourType" value="mafft-nwns"/>
            <param name="outputFormat" value="clustalw"/>
            <output name="outputClustalW" ftype="clustal" file="mafft_nwns_result.aln"/>
        </test>
    </tests>
    <help>
       <![CDATA[

.. class:: infomark

**MAFFT version 7.205 **

-----

**What it does**

MAFFT is a multiple sequence alignment program for unix-like operating systems.  
It offers a range of multiple alignment methods, L-INS-i (accurate; for alignment of <∼200 sequences), 
FFT-NS-2 (fast; for alignment of <∼30,000 sequences), etc.

From the MAFFT man page, an overview of the different predefined flavours of the tool.

**Accuracy-oriented methods:**

- L-INS-i (probably most accurate; recommended for <200 sequences; iterative refinement method incorporating local pairwise alignment information):
    
    - mafft --localpair --maxiterate 1000 input [> output]

- G-INS-i (suitable for sequences of similar lengths; recommended for <200 sequences; iterative refinement method incorporating global pairwise alignment information):
    
    - mafft --globalpair --maxiterate 1000 input [> output]

- E-INS-i (suitable for sequences containing large unalignable regions; recommended for <200 sequences):
    
    - mafft --ep 0 --genafpair --maxiterate 1000 input [> output]. For E-INS-i, the --ep 0 option is recommended to allow large gaps. 


**Speed-oriented methods:**

- FFT-NS-i (iterative refinement method; two cycles only):

    - mafft --retree 2 --maxiterate 2 input [> output]

- FFT-NS-i (iterative refinement method; max. 1000 iterations):

    - mafft --retree 2 --maxiterate 1000 input [> output]

- FFT-NS-2 (fast; progressive method):

    - mafft --retree 2 --maxiterate 0 input [> output]

- FFT-NS-1 (very fast; recommended for >2000 sequences; progressive method with a rough guide tree):

    - mafft --retree 1 --maxiterate 0 input [> output]

- NW-NS-i (iterative refinement method without FFT approximation; two cycles only):

    - mafft --retree 2 --maxiterate 2 --nofft input [> output]

- NW-NS-2 (fast; progressive method without the FFT approximation):

    - mafft --retree 2 --maxiterate 0 --nofft input [> output]

- NW-NS-PartTree-1 (recommended for ~10,000 to ~50,000 sequences; progressive method with the PartTree algorithm):

    - mafft --retree 1 --maxiterate 0 --nofft --parttree input [> output]

**Options:**

--auto
    Automatically selects an appropriate strategy from L-INS-i, FFT-NS-i and FFT-NS-2, according to data size. Default: off (always FFT-NS-2)
--adjustdirection
    Generate reverse complement sequences, as necessary, and align them together with the remaining sequences. In the case of protein alignment, these options are just ignored.
  
--op
    Gap opening penalty, default: 1.53
--ep
    Offset (works like gap extension penalty), default: 0.0
--maxiterate
    Maximum number of iterative refinement, default: 0
--clustalout
    Output: clustal format, default: fasta
--thread
    Number of threads (if unsure, --thread -1)

-----

==============
 Please cite: 
==============

"Parallelization_ of the MAFFT multiple sequence alignment program."


.. _Parallelization: http://bioinformatics.oxfordjournals.org/content/26/15/1899.long

**Katoh, Toh**

Bioinformatics 26:1899-1900, 2010. (describes the multithread version; Linux only)


"Multiple_ Alignment of DNA Sequences with MAFFT."


.. _Multiple: http://mbe.oxfordjournals.org/content/early/2013/02/08/molbev.mst010.full

**Katoh, Asimenos, Toh**

Methods in Molecular Biology 537:39-64, 2009. (outlines DNA alignment methods and several tips including group-to-group alignment and rough clustering of a large number of sequences)


"Improved_ accuracy of multiple ncRNA alignment by incorporating structural information into a MAFFT-based framework."


.. _Improved: http://www.biomedcentral.com/1471-2105/9/212

**Katoh, Toh**

BMC Bioinformatics 9:212, 2008. (describes RNA structural alignment methods)


"Recent_ developments in the MAFFT multiple sequence alignment program."


.. _Recent: http://bib.oxfordjournals.org/content/9/4/286.abstract

**Katoh, Toh**

Briefings in Bioinformatics 9:286-298, 2008. (outlines version 6; Fast Breaking Paper in Thomson Reuters' ScienceWatch)


"PartTree_: an algorithm to build an approximate tree from a large number of unaligned sequences." 


.. _PartTree: http://bioinformatics.oxfordjournals.org/content/23/3/372.abstract

**Katoh, Toh**

Bioinformatics 23:372-374, Errata, 2007. (describes the PartTree algorithm)


"MAFFT version 5: improvement_ in accuracy of multiple sequence alignment."


.. _improvement: http://nar.oxfordjournals.org/content/33/2/511.abstract

**Katoh, Kuma, Toh, Miyata**

Nucleic Acids Res. 33:511-518, 2005. (describes [ancestral versions of] the G-INS-i, L-INS-i and E-INS-i strategies)


"MAFFT: a novel method_ for rapid multiple sequence alignment based on fast Fourier transform."


.. _method: http://nar.oxfordjournals.org/content/30/14/3059.full

**Katoh, Misawa, Kuma, Miyata**

Nucleic Acids Res. 30:3059-3066, 2002.
 

-----    
    
==========
 Overview
==========    

MAFFT is a multiple sequence alignment program for unix-like operating systems. It offers a range of multiple alignment methods, L-INS-i wich is accurate for alignment with less than 200 sequences, FFT-NS-2 which is fast for alignment with less than 10000 sequences. 

-----

For further informations, please visite the MAFFT_ website.

.. _MAFFT: http://mafft.cbrc.jp/alignment/software/
         ]]>
    </help>
    <citations>
        <citation type="doi">10.1093/molbev/mst010</citation> 
    </citations>
</tool>
