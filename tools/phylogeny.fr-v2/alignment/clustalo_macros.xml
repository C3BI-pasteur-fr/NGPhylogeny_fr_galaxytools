<macros>
	<token name="@CLUSTALO_PATH@">clustalo</token>
    <token name="@CLUSTALO_COMMAND@">
		--threads \${GALAXY_SLOTS:-1}
		-i $input
		$dealign
		$clusteringGuideTree
		$clusteringIteration
		$nbrIter
		$maxGuideTreeIteration
		$maxHmmIterations

		--force
		-o $output

		#if $getTree.value == True:
		--guidetree-out=$guideTree
		#end if

		--outfmt=${outputFormat}
	</token>
	<xml name="clustalo_opt">
	 <param name="input" format="fasta" type="data" label="Source file" help="Fasta format"/>        
        <param name="dealign" type="boolean" falsevalue="" truevalue="--dealign" label="Dealign input sequences" help="Only use full if yours sequences are all ready aligned"/>     
        <param name="clusteringGuideTree" type="boolean" label="mBed-like clustering guide-tree" falsevalue="--full" truevalue="" checked="true"/> 
        <param name="clusteringIteration" type="boolean" label="mBed-like clustering iteration" falsevalue="--full-iter" truevalue="" checked="true" />
        <param name="nbrIter" type="select" label="Number of iterations">
            <option value="">default</option>
            <option value="--iter=1">1</option>
            <option value="--iter=2">2</option>
            <option value="--iter=3">3</option>
            <option value="--iter=4">4</option>
            <option value="--iter=5">5</option>
        </param>
        <param name="maxGuideTreeIteration" type="select" label="Maximum guide tree iterations">
            <option value="">default</option>
            <option value="--max-guidetree-iterations=1">1</option>
            <option value="--max-guidetree-iterations=2">2</option>
            <option value="--max-guidetree-iterations=3">3</option>
            <option value="--max-guidetree-iterations=4">4</option>
            <option value="--max-guidetree-iterations=5">5</option>
        </param>        
        <param name="maxHmmIterations" type="select" label="Maximum number of HMM iterations">
            <option value="">default</option>
            <option value="--max-hmm-iterations=1">1</option>
            <option value="--max-hmm-iterations=2">2</option>
            <option value="--max-hmm-iterations=3">3</option>
            <option value="--max-hmm-iterations=4">4</option>
            <option value="--max-hmm-iterations=5">5</option>
        </param>
        <param name="getTree" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Display tree guide ?"/>
        <param name="outputFormat" type="select" label="Alignment Output format">
            <option value="fa" selected="true">FASTA</option>
            <option value="clu">Clustal</option>
            <option value="phy">Phylip</option>
        </param>
    </xml>
    <xml name="clustalo_output">
        <data name="output" format="fasta" label="${tool.name} aligned sequencies">
            <change_format>
                  <when input="outputFormat" value="clu" format="clustal"/>
                  <when input="outputFormat" value="phy" format="phylip"/>
             </change_format>
        </data>    
        <data name="guideTree" format="txt" label="${tool.name} Guide tree">
            <filter>getTree == True</filter>
        </data> 
    </xml>
</macros>