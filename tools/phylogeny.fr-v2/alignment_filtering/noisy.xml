<tool id="noisy" name="Noisy" version="1.5.12.1">
    <description>Cleaning aligned sequences</description>
    <requirements>
        <requirement type="package" version="1.5.12">Noisy</requirement>
    </requirements>
    <command>noisy  
                 $input
                 --seqtype $seqtype
                 --cutoff $cutoff
                 --distance $distance
                 #if $usematrix.matrix == "true":
                    --matrix $usematrix.matrixfile
                 #end if
                 #if $missingchar.setmissingchar == "true":
                    --missing $missingchar.chars
                 #end if
                 --ordering
                 #if $orderingmethode.ordering == "rand":
                   RAND[,$orderingmethode.randpermut]
                 #else if $orderingmethode.ordering == "list":
                   $orderingmethode.randpermutlist
                 #else:
                   $orderingmethode.ordering
                 #end if
                 
                 ##--noconstant
                 ##--nogap
                 
                 ##--reorder
                 ##--shuffles
                 ##--smooth
                 --silent
                 ##--verbose
                 
    </command>
	<inputs>
		<param name="input" type="data" format="fasta" label="Source file"
			help="Fasta format" />
		<param name="seqtype" type="select" label="Sequence Coding">
			<option value="D">DNA</option>
			<option value="P">Protein</option>
			<option value="R">RNA</option>
		</param>
		<param name="cutoff" type="float" value="0.8" min="0" max="1"
			label="cut-off  [ 0-1 ]"
			help="Columns with a score below FLOAT are removed from the output alignment." />
		<param name="distance" type="select" label="Distance methode used by NeighbotNet">
		    <option value="HAMMING">HAMMING</option>
            <option value="GTR">GTR</option>
        </param>
        <conditional name="usematrix">
         <param name="matrix" type="boolean"  truevalue="true" falsevalue="" checked="False" label="Use matrix file" help="default is calculate distances with nnet"/>
         <when value=""/>
         <when value="true">
            <param name="matrixfile" format="text" type="data" label="matrix file"/>
         </when>
        </conditional>
        <conditional name="missingchar">
            <param name="setmissingchar" type="boolean" truevalue="true" falsevalue="" checked="False" label="Set list of missing chars" />
            <when value=""/>
            <when value="true">
                <param name="chars" type="text" label="Missing chars list"/>
            </when>
        </conditional>
        <conditional name="orderingmethode">
	        <param name="ordering" type="select" display="radio" label="Choose ordering method">
	            <option value="nnet">NeighborNet</option>
	            <option value="qnet">QNet</option>
	            <option value="rand">Sample INT random permutation</option>
	            <option value="list">Provide ordering</option>
	            <option value="all">All permutations</option>
	         </param>
	            <when value="nnet"/>
	            <when value="qnet"/>
	            <option value="all"/>
	            <when value="rand">
	                <param name="randpermut" type="integer" value="1000" label="random permutation"/>
	            </when>
	            <when value="list">
	                <param name="randpermutlist" type="text" label="Comma-seperated string of INT"/>
	            </when>  
         </conditional>
         
	</inputs>

	<outputs>
		<data name="output1" format="fasta" label="Noisy Cleaned sequencies"  from_work_dir="*_out.fas" />
		<data name="output2" format="eps" label="Noisy Cleaned sequencies"  from_work_dir="*typ.eps" />
	</outputs>
<help>
<![CDATA[ 
Usage: noisy [OPTIONS] MultiFastaAlignment
Options:
 --cutoff FLOAT     Set cutoff value to FLOAT.
                     (default is >0.80<)
 --distance STRING  Distance methode used by NeighbotNet.
                     (default is >HAMMING< [HAMMING|GTR])
 -h, --help         Print usage message for noisy.
 --matrix FILE      Use distance matrix for NeighbotNet from FILE.
                     (default is >calculate distances with nnet<)
 --missing STRING   Set list of missing characters to STRING.
                     (default is >N<)
 --nogap            Don't count gap symbol as character state.
                     (default is >0<)
 --noconstant       Ignore constant columns in output alignment.
                     (default is >0<)
 --ordering STRING
                    Choose ordering method.
                     (default is >nnet<)
                    nnet         NeighborNet
                    qnet         QNet
                    rand[,INT]   sample INT random permutation
                                (default is >1000<)
                    INT,INT,...  provide ordering explicitly as
                                comma-seperated string of INTs
                    all          all permutations
 -r, --reorder      Only reorder alignment rows (do not shuffle)
                     (default is >1000<)
 --shuffles INT     Perform INT random shuffles per column.
                     (default is >0<)
 -s, --silent       Turn off status bar
                     (default is >0<)
 --smooth INT       Running avarage over INT columns.
                     (default is >1<)
 --seqtype CHAR     Set sequence type of input alignment to CHAR
                     (default is >D<) [D=DNA, P=Protein, R=RNA]
 -v, --verbose      Verbose mode. Causes noisy to print debugging
                    messages about its progress.
]]>
</help>
 <citations>
        <citation type="doi">10.1186/1748-7188-3-7</citation> 
 </citations>
</tool>